---
layout: post
status: publish
published: true
title: Converting Java Code to C# Code Using Sharpen To Create a SharePoint Solution
  - Part 1
author:
  display_name: blog_admin
  login: blog_admin
  email: daniel.paulus@me.com
  url: ''
author_login: blog_admin
author_email: daniel.paulus@me.com
wordpress_id: 29
wordpress_url: http://devtopics.de/?p=29
date: '2013-06-04 13:07:56 +0200'
date_gmt: '2013-06-04 11:07:56 +0200'
categories:
- Allgemein
- Code
tags:
- Java
- C#
- SharePoint
- Sharpen
- Versant
- Coding
comments:
- id: 163
  author: Andreas
  author_email: andi2@grill.to
  author_url: ''
  date: '2013-11-15 13:13:11 +0100'
  date_gmt: '2013-11-15 11:13:11 +0100'
  content: "Hi! I'm wondering what happened to part 2? Did you encounter lots of problems
    with converting a more complicated example?\r\nbest regards\r\nandreas"
- id: 164
  author: daniel
  author_email: nemschok@yahoo.de
  author_url: http://devtopics.de/?page_id=52
  date: '2013-11-15 22:07:24 +0100'
  date_gmt: '2013-11-15 20:07:24 +0100'
  content: |-
    Hi, well I planned to integrate a product the java guys at my company built into a SharePoint solution but after further analysis found out that I was better off
    rebuilding it from ground up. Their code was not what i expected. :-(
- id: 266
  author: auto-colorizer for google plus and facebook
  author_email: derrickmerrifield@live.com
  author_url: http://plus.google.com/
  date: '2015-06-25 21:20:09 +0200'
  date_gmt: '2015-06-25 19:20:09 +0200'
  content: "I appreciate, result in I discovered exactly what I used to be taking
    \r\na look for. You've ended my four day lengthy hunt! God Bless you man. Have
    a great \r\nday. Bye"
- id: 267
  author: weight loss tips from anorexia
  author_email: annettemckinney@gawab.com
  author_url: http://www.markweblink.info/story.php?title=howtolose10pounds-org-3
  date: '2015-06-27 02:48:47 +0200'
  date_gmt: '2015-06-27 00:48:47 +0200'
  content: "This is the place I started out also it would be a great start to suit
    your needs as well.\r\nWhen you are thinking about a diet, whether it is something
    \r\nyou wont be capable of sustain seek out another one.\r\nOf course we all know
    that to slim down quickly you \r\nhave to eat less."
---
<p>For an explorative prototype project I wanted to use some existing Java code to build a SharePoint plugin. Therefore, the first thing that needs to be done is create some C# code for the backend. I found out about "Sharpen" an automatic conversion tool built and open sourced by <a title="versant community" href="http:&#47;&#47;community.versant.com" target="_blank">versant<&#47;a></p>
<p>I used the <a title="Versant Community" href="http:&#47;&#47;community.versant.com&#47;Blogs&#47;db4o&#47;tabid&#47;197&#47;entryid&#47;95&#47;Default.aspx">tutorial<&#47;a> taken from versants community pages and followed these steps using eclipse and its subclipse svn client:</p>
<ul>
<li>Checkout sharpen.core from db4o's subversion repository at https:&#47;&#47;source.db4o.com&#47;db4o&#47;trunk&#47;sharpen&#47;<&#47;li>
<li>Right click the freshly checked out project in the "Package Explorer" and choose "Export" from the context menu;<&#47;li>
<li>Expand the "Plug-in Development" folder and select "Deployable plug-ins and fragments";<&#47;li>
<li>Set "Destination" to the root folder of your eclipse installation and click "Finish";<&#47;li><br />
<&#47;ul><br />
After completing these steps I created a simple java project called "ConverterTest". Then I created my class "SomeClass.java" in package "de". I added some simple code like this:</p>
<pre class="brush: java; gutter: true">package de;</p>
<p>public class SomeClass {</p>
<p>	public String dude;</p>
<p>	public SomeClass() {<br />
		dude = "convert me!";</p>
<p>	}</p>
<p>	public void print() {</p>
<p>		System.out.print(dude);</p>
<p>	}</p>
<p>}<&#47;pre><br />
Since I am only interested in converting source code and not so much in automated C# builds I modified the example xml ant files accordingly. So in my ConverterTest project i created my build.xml ant-file:</p>
<pre class="brush: xml; gutter: true">
<project name="ConverterTest" default="sharpen">
<p>        <import file="build-properties.xml" &#47;><br />
        <import file="sharpen-common.xml" &#47;></p>
<p>        <target name="sharpen" depends="init"></p>
<prepare-sharpen-workspace project="ConverterTest" dir="${sharpen.workspace.dir}" &#47;>
            <sharpen workspace="${sharpen.workspace.dir}" resource="ConverterTest&#47;src"><br />
            <&#47;sharpen></p>
<p>        <&#47;target></p>
<p>        <target name="init"></p>
<p>            <reset-dir dir="${sharpen.workspace.dir}" &#47;></p>
<p>        <&#47;target></p>
<p>    <&#47;project><&#47;pre><br />
Then I created build-properties.xml like this:</p>
<pre class="brush: xml; gutter: true"><?xml version="1.0" encoding="UTF-8"?></p>
<project name="build properties">
<property name="sharpen.workspace.dir" value="build" &#47;>
<property name="eclipse.home" value="d:&#47;[path to eclipse]" &#47;>
    <&#47;project><&#47;pre><br />
Finally I downloaded the <a title="sharpen-common.xml" href="https:&#47;&#47;source.db4o.com&#47;db4o&#47;trunk&#47;sandbox&#47;blogs&#47;SharpenExamples&#47;ContactList&#47;sharpen-common.xml" target="_blank">sharpen-common.xml<&#47;a> and placed it in my project. Then I ran my build.xml file as an Ant Build using the context menu and the "Run As->Ant Build" command. Then I automagically got the following C# code in "build&#47;ConverterTest.net&#47;src&#47;de&#47;SomeClass.cs"</p>
<pre class="brush: csharp; gutter: true">namespace de<br />
{<br />
	public class SomeClass<br />
	{<br />
		public string dude;</p>
<p>		public SomeClass()<br />
		{<br />
			dude = "convert me!";<br />
		}</p>
<p>		public virtual void print()<br />
		{<br />
			System.Console.Out.Write(dude);<br />
		}<br />
	}<br />
}<&#47;pre><br />
An here we go :-) Obviously the generated code violates some source code naming conventions but what is important is that it is runnable. The rest can easily be fixed using resharper or Visual Studios built in refactoring tools. Next I'll try to convert some complicated code in Part 2.</p>
