---
layout: post
title:  "Writing a Powershell Skript for Auto Deploy of Jekyll site"
date:   2016-02-25 14:34:48 +0100
categories: jekyll update
---

I used a simple Powershell script to generate a list of ftp commands. This way i can upload my Jekyll Site 
automatically. 


{% highlight powershell %}

$scriptpath= Split-Path -Parent $PSCommandPath

$settings= cat ($scriptpath+"\settings.json") | ConvertFrom-Json
$ftp_host=$settings.ftp_host

$ftp_commands=@($settings.user,$settings.pwd,"cd "+$settings.remoteroot)
$localpath= $settings.localpath



$dirs= dir $localpath -recurse | ? {$_.GetType().Name -eq "DirectoryInfo"}


foreach ($dir in $dirs){
$remotepath=$dir.parent.fullname.replace($localpath, "/web")
$remotepath=$remotepath.replace("\","/")
$ftp_commands+="cd "+$remotepath
$ftp_commands+= "mkdir "+ $dir.Name
$ftp_commands+="cd "+$dir.Name

foreach($f in $dir.GetFiles()){
  $ftp_commands+="put "+$f.fullname
}
}

$rootfiles+= ls $localpath |? {$_.GetType().Name -eq "FileInfo"}
$ftp_commands+="cd /web"
foreach($f in $rootfiles){
  $ftp_commands+="put "+$f.fullname
}

$ftp_commands+="quit"

$ftp_commands| out-file ($scriptpath+"\ftpcmds.dat")
invoke-expression "ftp -s:$($scriptpath+"\ftpcmds.dat") $ftp_host"
rm ($scriptpath+"\ftpcmds.dat")
{% endhighlight %}

Check out the [Jekyll docs][jekyll-docs] for more info on how to get the most out of Jekyll. File all bugs/feature requests at [Jekyllâ€™s GitHub repo][jekyll-gh]. If you have questions, you can ask them on [Jekyll Talk][jekyll-talk].

[jekyll-docs]: http://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/
